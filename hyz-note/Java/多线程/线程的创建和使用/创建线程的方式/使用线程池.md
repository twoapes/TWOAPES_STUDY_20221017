# 使用线程池

> 1.指定线程数量的线程池
2.执行指定线程的操作,需要实现Runable或Callable接口实现类的对象
3.关闭连接池

实现Callable接口或者Runnable接口都可以， 由ExecutorService来创建线程

工作中不建议使用Executors创建线程池,而是直接使用线程池ThreadPoolExecutor的构造器
背景：经常创建和销毁、使用量特别大的资源，比如并发情况下的线程，对性能影响很大
思路：提前创建好多个线程，放入线程池中，使用时直接获取，使用完放回池中。可以避免频繁创建销毁、实现重复利用。类似生活中的公共交通工具
corePoolSize：核心池的大小
maximumPoolSize：最大线程数
keepAliveTime：线程没有任务时最多保持多长时间后会终止

好处

提高响应速度(减少了创建新线程的时间)
降低资源消耗(重复利用线程池中线程，不需要每次都创建)
便于线程管理

使用Java实现ExecutorService相关的线程池的步骤如下：

1. 导入所需的类库。

```java
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
```

2.创建一个ExecutorService对象，使用Executors类提供的静态方法创建线程池。

```java
ExecutorService executorService = Executors.newFixedThreadPool(5);
```

3.定义一个实现Runnable接口的任务类，用于描述线程要执行的逻辑。

```java
public class MyRunnable implements Runnable {
    public void run() {
        // 线程执行的逻辑
    }
}
```

4.将任务提交给线程池执行。使用execute()方法将任务提交给ExecutorService对象。

```java
MyRunnable myRunnable = new MyRunnable(); // 创建任务实例
executorService.execute(myRunnable); // 提交任务给线程池执行
```

5.关闭线程池。在不需要使用线程池时，调用shutdown()方法关闭线程池，释放资源。

```java
executorService.shutdown();
```

完整示例代码如下：

```java
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Main {
    public static void main(String[] args) {
        // 创建线程池
        ExecutorService executorService = Executors.newFixedThreadPool(5);

        // 定义任务类
        class MyRunnable implements Runnable {
            public void run() {
                // 线程执行的逻辑
                for (int i = 0; i < 10; i++) {
                    System.out.println("Thread: " + i);
                }
            }
        }

        // 提交任务给线程池执行
        MyRunnable myRunnable = new MyRunnable();
        executorService.execute(myRunnable);

        // 关闭线程池
        executorService.shutdown();
    }
}
```

## ExecutorService

- JDK 5.0起提供了线程池相关API

真正的线程池接口

```txt
void execute(Runnable command) ：执行任务/命令，没有返回值，一般用来执行Runnable
<T> Future<T> submit(Callable<T> task) ：执行任务， 有返回值， 一般又来执行Callable
void shutdown()：关闭连接池
```

## Executors

工具类、线程池的工厂类，用于创建并返回不同类型的线程池

```txt
Executors.newCachedThreadPool() ：创建一个可根据需要创建新线程的线程池
Executors.newFixedThreadPool(n) ； 创建一个可重用固定线程数的线程池
Executors.newSingleThreadExecutor() ：创建一个只有一个线程的线程池
Executors.newScheduledThreadPool(n) ：创建一个线程池， 它可安排在给定延迟后运行命令或者定期地执行
```
