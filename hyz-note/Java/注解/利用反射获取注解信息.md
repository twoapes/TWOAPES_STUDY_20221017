# 利用反射获取注解信息

- JDK5.0在`java.lang.reflect`包下新增了AnnotatedElement接口, 该接口代表程序中可以接受注解的程序元素

- 当一个 Annotation类型被定义为运行时Annotation后, 该注解才是运行时可见, 当class文件被载入时保存在class文件中的Annotation才会被虚拟机读取

- 程序可以调用AnnotatedElement对象的如下方法来访问Annotation信息

以下是一个使用Java反射机制获取注解信息的示例代码：

```java
import java.lang.annotation.Annotation;
import java.lang.reflect.Method;

@MyAnnotation("示例注解")
public class ReflectionAnnotationDemo {

    @MyAnnotation("方法注解")
    public void myMethod() {
        // 方法体
    }

    public static void main(String[] args) {
        Class<?> clazz = ReflectionAnnotationDemo.class;

        // 获取类上的注解信息
        Annotation[] classAnnotations = clazz.getAnnotations();
        for (Annotation annotation : classAnnotations) {
            if (annotation instanceof MyAnnotation) {
                MyAnnotation myAnnotation = (MyAnnotation) annotation;
                System.out.println("类上的注解值: " + myAnnotation.value());
            }
        }

        // 获取方法上的注解信息
        try {
            Method method = clazz.getDeclaredMethod("myMethod");
            Annotation[] methodAnnotations = method.getAnnotations();
            for (Annotation annotation : methodAnnotations) {
                if (annotation instanceof MyAnnotation) {
                    MyAnnotation myAnnotation = (MyAnnotation) annotation;
                    System.out.println("方法上的注解值: " + myAnnotation.value());
                }
            }
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        }
    }
}
```

在示例代码中，我们定义了一个包含注解的类`ReflectionAnnotationDemo`。该类使用了自定义注解`@MyAnnotation`，并在类和方法上分别添加了注解。

在`main`方法中，我们首先通过`clazz.getAnnotations()`方法获取类上的所有注解，然后遍历注解数组，判断是否为`MyAnnotation`注解，并打印注解值。

接着，我们使用反射获取`myMethod`方法的注解信息。首先通过`clazz.getDeclaredMethod("myMethod")`方法获取指定方法，然后使用`method.getAnnotations()`方法获取方法上的所有注解，同样遍历注解数组，判断是否为`MyAnnotation`注解，并打印注解值。

运行该示例代码，将会输出以下结果：

```java
类上的注解值: 示例注解
方法上的注解值: 方法注解
```

这说明通过使用反射机制，我们可以获取类和方法上的注解信息。通过`getAnnotations()`方法获取注解数组，遍历数组判断注解类型，并进行相应的处理。这样我们可以在运行时动态地获取和利用注解的信息。
